# 【Java虚拟机】问题汇总

## 一、关于内存区域与对象

### 1、Java 的运行时内存区域划分了几块？分别有什么作用？哪些是线程私有的？

一共有五个部分，分别是：

- **程序计数器**
  - 可看作当前线程所执行的字节码的行号指示器，用来控制程序执行流程，如分支、跳转、循环等
  - 线程私有
  - 不会报 OutOfMemoryError
- **Java 虚拟机栈**
  - 指的是 Java 方法执行的线程内存模型。每个方法被执行的时候，JVM 会同步创建一个栈帧，用于存储局部变量表、操作数栈、动态链接和方法出口等信息。每个方法被调用时入栈，执行完毕后出栈。
  - 线程私有
  - 栈不够深会报 StackOverflowError，栈不够内存扩展会报 OutOfMemoryError
- **本地方法栈**
  - 与 Java 虚拟机栈相似，不同之处在于虚拟机栈是为执行的 Java 方法服务；而本地方法栈是为虚拟机使用到的本地方法服务
  - 线程私有
- **Java 堆**
  - 用于存放对象实例
  - 共享内存区域
  - 垃圾收集器管理的内存区域
  - 堆无法扩展时，会报 OutOfMemoryError
- **方法区**
  - 用于存储已被虚拟机加载的类型信息、常量、静态变量等数据
  - 共享内存区域
  - 可以被垃圾收集器管理：常量池回收和类型的卸载

### 2、运行时常量池在内存中的哪里？能否在运行期间加入新的常量？

运行时常量池在 **方法区** 中。具体过程：

- 在进行编译的过程中，会将产生的 **字面量、符号引用** 等信息记录为 **常量池表**，存在 Class 文件中
- 当类加载后，常量池表的内容就放入方法区的运行时常量池中

运行时常量池的特点就是 **动态性** ！能够支持运行期间加入新的常量，如使用 `String#intern()` 方法。











